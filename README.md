# OPARL - Online Mario Level Generation from Music

This is the code for the paper "Online Mario Level Generation from Music" accepted by the 2022 IEEE Conference on Games.

Please use this bibtex if you use this repository in your work:

````
@inproceedings{wang2022online,
  title={Online Mario Level Generation from Music},
  author={Wang, Ziqi and Liu, Jialin},
  booktitle = {Conference on Games},
  year={2022},
  pages={Accepted},
  organization={IEEE}
}
````
* **A demo video of A\* agent playing a level generated by our method from a piece of blended music is accessible in this repository:** https://github.com/SUSTechGameAI/OPARL/blob/master/blended%20music-demo.mp4
### Environments that have been tested
* Python 3.9.6
* JPype 1.3.0
* pygame 2.0.1
* librosa 0.9.1
* dtw 1.4.0
* scipy 1.7.2
* torch 1.9.0+cu111
* numpy 1.20.3
* gym 0.21.0
### How to use
#### Training GAN generator:
Run command line instruction:
````
At the root path of this project> python train.py generator
````
You can check the running arguments (to specify algorithm parameters) by:
````
At the root path of this project> python train.py generator --help
````
#### Training CNet:
Run command line instruction:
````
At the root path of this project> python train.py cnet
````
You can check the running arguments (to specify algorithm parameters) by:
````
At the root path of this project> python train.py cnet --help
````
#### Training CNet:
Run command line instruction:
````
At the root path of this project> python train.py designer
````
You can check the running arguments (to specify algorithm parameters) by:
````
At the root path of this project> python train.py designer --help
````
#### Play a level:
You may modify the path of level file in line 322 of the _smb.py_, and then run _smb.py_ to play any level stored in a Mario-AI-Framework-supported text file.
* Line 278 of _smb.py_
````
    lvl = MarioLevel.from_txt('Path of your level file')
````
The path can be either related (to project root) or absolute, and the file type won't be checked.